## 21 - 防抖与节流

防抖和节流都是闭包的应用

## 防抖（debounce）

单反相机中的防抖是拍摄时的抖动，让人拍出清晰的照片，JavaScript 中的防抖也是防止抖动。

频繁触发一个事件时，会引起不必要的性能损失，那么让事件在停止触发后再触发，以此减少部分性能损失

### 是什么

> 防抖就是要延迟执行，你一直操作触发事件一直不执行，当你停止操作等待多少秒后才执行
>
> 也就是说不管事件触发频率有多高，一定再事件触发n 秒后执行。
> 如果在事件触发的n 秒又触发了这个事件，那就以新事件的事件为准，n 秒后才执行。
> 总之，要等你触发完事件n 秒内不再触发事件，它才执行

### 手写防抖

```javascript
function debounce(event, wait) {
  let timer = null;
  return function(){
    clearTimeout(timer);  // 清除setTimeout，使其回调函数不执行
    timer = setTimeout(() => event.apply(this, arguments), wait);
  };
}
```

```javascript
/**
 * @param {Boolean} isExecuteImmediately - 是否立即执行
*/
function debounce(event, wait, isExecuteImmediately) {
  let timer = null;
  return function (){
    clearTimeout(timer);

    if(!timer && isExecuteImmediately) {
      event.apply(this, arguments);
    } else {
      timer = setTimeout(()=> event.apply(this, arguments), wait);
    }
  }
}
```

### 使用场景

#### 窗口大小变化，调正样式

#### 搜索框，输入后 1000 毫秒搜索

#### 表单验证，输入 1000 毫秒后验证

#### 防抖帝王库

## 节流（throttle）

### 是什么

### 手写节流

#### 时间戳

#### 定时器

#### 时间戳 + 定时器

### 使用场景

#### scroll 滚动

#### input 动态搜索

#### 节流帝王库

## 总结

## 参考资料

- [深入理解JavaScript——闭包](https://zhuanlan.zhihu.com/p/574913236) [知乎 @Johan 约翰]